# 엑셀→노션 자동화 2단계 실전 매뉴얼 (2025.06)

## 1. 작업 개요 및 목표
- **목표:** 엑셀(통합주소록100-2.xlsx) 데이터를 노션 DB(회사정보 V1.1)에 완전 자동화 방식으로 업로드, 중복 검증, 회사ID/인덱스 자동 부여까지 실현
- **핵심:** 엔터프라이즈급 데이터 품질, 자동화, 확장성, 실시간 모니터링

---

## 2. 작업 경과 및 결과

### 1차: 기존 데이터 고도화
- 노션 DB(100건) 백업 및 중복 제거
- 회사ID(CO-00001~CO-00100) 자동 부여

### 2차: Universal Data Adapter 개발 및 실전 적용
- 엑셀 데이터(100건) 구조 자동 분석, 공란/포맷 정규화
- 필드 자동 매핑(회사명, 사업자등록번호, 전화번호, 팩스번호, 대표이사)
- 전화번호/팩스번호는 문자열로 읽고, 노션 phone_number 타입에 맞게 자동 변환
- 중복 검증(사업자등록번호, 회사명 유사도 90% 이상)
- 중복 제외 후 **신규 89건**만 노션에 자동 업로드

### 3차: 회사ID/인덱스 자동 부여
- 신규 업로드된 행(회사ID 비어있는 행)에 CO-00101~CO-00189 자동 부여
- 회사ID 순서대로 인덱스(순번) 컬럼 1~189까지 자동 입력

### 최종 결과
- 노션 DB 총 189건, 회사ID/인덱스 모두 연속성/정확성 보장
- 중복 데이터 없음, 데이터 품질/포맷(전화번호/팩스번호) 정상
- 실시간 진행 보고, 오류/실패 0건

---

## 3. 교훈 및 앞으로 꼭 기억할 점

- **노션 인테그레이션 권한:**
  - 반드시 "연결" 메뉴에서 인테그레이션을 DB에 초대해야 API 접근 가능
- **DB ID/필드 타입 정확성:**
  - 상위 페이지 ID와 DB ID 혼동 금지, phone_number 등 필드 타입 변경 시 코드도 함께 수정
- **전화번호/팩스번호:**
  - dtype=str로 읽고, phone_number 타입으로 입력해야 앞의 0이 유지됨
- **중복 검증:**
  - 사업자등록번호 100% 일치, 회사명 Jaro-Winkler 90% 이상 유사도 기준
- **회사ID/인덱스 자동화:**
  - 신규 데이터는 업로드 후 회사ID/인덱스 자동 부여(코드 활용)
- **실시간 모니터링:**
  - 10건 단위 진행 보고, 오류/중복/신규 건수 실시간 확인
- **백업:**
  - 대량 작업 전 반드시 노션 DB 전체 백업

---

## 4. 실무적 의미 및 확장성

- **완전 자동화:**
  - 수동 개입 없이 엑셀→노션 데이터 이전, 품질 검증, ID/인덱스 관리까지 자동화
- **확장성:**
  - 대용량, 다중 파일, 다양한 구조의 엑셀도 Universal Adapter로 대응 가능
- **재사용성:**
  - 표준 코드/매뉴얼/템플릿화로 반복 작업, 신규 프로젝트에 즉시 적용 가능
- **엔터프라이즈 품질:**
  - 중복/오류/포맷 문제 없는 고품질 데이터베이스 구축

---

## 5. 앞으로의 실전 팁

- 노션 DB/필드 구조 변경 시, 코드/매핑도 반드시 함께 점검
- 인테그레이션/토큰/DB ID 등 환경설정은 .env 등 안전하게 관리
- 실시간 진행 보고, 자동화 로그, 백업 파일을 항상 남길 것
- 신규 데이터 업로드 후, 회사ID/인덱스 자동화 스크립트로 마무리

---

> **이 문서와 자동화 코드를 노션/위키/깃허브에 저장해두고, 반복 작업/신규 프로젝트에 그대로 활용하세요!** 